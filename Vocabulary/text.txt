Основы безопасности
В этой главе мы познакомимся с основами, базовой теорией взлома web-сайтов и 
выясним, каким образом идет поиск уязвимостей. В начале главы поверхностно будет затронута тема социальной инженерии, в дальнейшем мы не будем использовать ее (ну, может, совсем чуть-чуть) для достижения необходимого результата. 
Содержимое этой главы пересекается с некоторыми отрывками из других моих 
книг, потому что мне уже много приходилось писать о безопасности. В этой главе я 
собрал самое интересное из своих предыдущих работ (но не все, а только то, что 
касается web), дополнил и обновил информацию с учетом текущих реалий. Даже 
если вы читали мои предыдущие книги, эта глава не должна стать для вас скучным 
чтивом. 
1.1. Социальная инженерия 
Социальная инженерия — это очень мощное оружие, которое может срабатывать 
даже там, где программы на сервере написаны идеально, потому что она использует самое слабое звено — человека. Наверное, каждая уязвимость связана с человеческим фактором, ведь серверные программы, в которых мы будем искать уязвимости, написаны человеком и именно он делает ошибку, которая приводит к взлому. 
В данном случае социальная инженерия ищет слабое место (можно сказать, уязвимость, если проводить аналогию с программами) в человеке. 
С помощью социальной инженерии происходило большинство наиболее громких 
взломов и создавались самые известные вирусы. В моей молодости много шума 
наделал вирус "Анны Курниковой", когда пользователям приходило письмо с 
вложением и предложением посмотреть фотографию обнаженной Анны. Это тоже социальная инженерия, которая играет на слабостях человека. Любопытство 
мужчин, которые запускали прикрепленный файл и таким образом заражали свой 
компьютер, помогло распространению этого вируса. А ведь на тот момент мужская половина была бóльшей частью пользователей интернета. В данном случае 
использовалась слабость (можно снова назвать уязвимостью) человека — любопытство и похоть. 
12 Глава 1 
Социальная инженерия основана на психологии человека и использует его слабые 
стороны. С ее помощью хакеры заставляют жертву делать то, что им нужно: заражают компьютеры, получают пароли. Сколько раз я слышал про украденные номера кредитных карт с помощью простых почтовых сообщений. Пользователь получает письмо с просьбой сообщить свой пароль, потому что база данных банка порушилась из-за погодных условий, проказ хакера или неисправности оборудования. 
Ничего не подозревающие пользователи всегда сообщают данные, потому что боятся потерять информацию. 
Да, в последнее время доверчивость у пользователей интернета уменьшается благодаря СМИ. Теперь уже все сложнее найти человека, который откроет свой пароль 
в ответ на поддельное письмо от службы поддержки. Сейчас наоборот, пользователи боятся использовать некоторые защищенные и очень полезные сервисы. Но и 
хакеры не дремлют и ищут все новые и новые методы, все более изощренные способы обмануть людей. 
Есть и такие хакеры, которые редко придумывают что-либо новое, а используют 
старые и проверенные способы. И, несмотря на это, всегда находятся те, кто попадаются на удочку. Я пользуюсь интернетом уже очень долгое время и ежедневно 
получаю десятки писем с просьбой запустить файл для обновления защиты или для 
того, чтобы увидеть что-то интересное. А ведь достаточно часто отправители — 
пользователи зараженных компьютеров. Значит, кто-то открывает такие вложения. 
Я никогда не открываю вложения, и это одна из причин, почему мне не нужны антивирусы уже лет 15. 
Несмотря на широкое использование защитных программных комплексов и антивирусных программ, количество вирусов не уменьшается, а если и уменьшается, то не 
сильно. Каждый день в интернете появляются новые пользователи, которые еще 
ничего не знают о мерах предосторожности. Именно они чаще всего попадаются на 
различные уловки. 
Итак, давайте рассмотрим некоторые способы, которыми пользуются хакеры. Это 
поможет вам распознавать их и отделять попытки психологического воздействия от 
простого общения с людьми. Помните, что социальная инженерия максимально 
сильна в интернете, когда вы не можете воочию оценить намерения своего собеседника. 
Классика — взлом через смену пароля. Жертве приходит письмо с просьбой обновить свои реквизиты на web-странице банка, и при этом ссылка из письма указывает совершенно на другой web-сайт, где введенные пользователем данные попадают 
в руки хакеру. 
Мне регулярно приходят письма, в которых используется очень старый и давно забытый способ социальной инженерии. Письмо имеет примерно следующее содержание: "Здравствуйте. Я администратор компании ХХХХХ. Наша база была подвержена атаке со стороны хакера, и мы боимся, что некоторые данные были изменены. Просьба просмотреть следующую информацию, и если что-то неверно, то 
сообщите мне, я восстановлю данные в базе". 
Основы безопасности 13 
После этого может идти перечисление данных обо мне, которые легко получить 
через социальные сети. 
У меня есть сайты, поэтому мои данные легко находят в интернете с помощью сервиса whois. На любом web-сайте регистрации доменов есть такая служба, позволяющая определять имя владельца домена. Хакер может воспользоваться этим и 
указать в письме всю найденную информацию. Помимо этого, он может указать 
еще два параметра: имя пользователя и пароль. Конечно же, эти данные хакер, скорее всего, не знает, поэтому здесь будут неверные значения. Кое-кто из пользователей при получении таких писем теряется и, волнуясь за свой web-сайт, открывает 
ссылку из письма, которая ведет на зловредный сайт, и там через какую-либо форму 
сообщает хакеру уже правильные параметры доступа. 
Данный метод использует хороший психологический прием: сначала приводится 
достоверная информация, и только в параметрах доступа заложена ошибка. Таким 
образом завоевывается расположение и доверие жертвы, и если пользователь незнаком с таким принципом социальной инженерии, то вероятность получить пароль 
достаточно высока. Это подтверждает не только множество знаменитых взломов в 
80-х годах прошлого столетия, но и то, что этот метод существует и работает даже 
в наши дни. 
Сейчас количество взломов этим методом сократилось, однако это может быть 
лишь затишьем перед бурей. Пользователи могут расслабиться, и атака снова станет популярной. Ведь все новое — это хорошо забытое старое. Если немного модифицировать подход, чтобы пользователи сразу не заметили подвоха, то атака 
может стать очень эффективной. 
Задача хакера — войти в доверие к защищающейся стороне и узнать пароли доступа. Для этого используются психологические приемы воздействия на личность. Человеку свойственны любопытство, доверчивость и чувство страха. Любое из этих 
чувств может стать причиной утери информации. 
Благодаря излишнему любопытству мы верим призывам открыть прикрепленный к 
письму файл и самостоятельно запускаем на своем компьютере вирусы. В силу нашей доверчивости хакерам удается узнать секретную информацию. Но самые сильные эмоции вызывает страх. Именно на страхе и боязни потери паролей основана 
большая часть атак, с помощью которых пользователя вынуждают сказать необходимые сведения. 
Еще две слабости, которые очень часто приводят к положительному результату, — 
жадность и алчность. Деньги портят людей, а хакеры умеют этим пользоваться. 
Наилучший результат достигается тогда, когда хакер использует сразу несколько 
слабостей: например, страх и любопытство одновременно. 
У нас на работе есть отдел, который занимается безопасностью. Они регулярно 
рассылают письма с напоминанием, что нельзя открывать ссылки из писем, источник которых нам неизвестен. Несмотря на то, что многие прекрасно знают о проблемах безопасности, подобные напоминания помогают держать нас в тонусе. 
14 Глава 1 
Крупные и громкие взломы происходят циклично. Пара-тройка крупных взломов, 
после чего может быть тишина в течение продолжительного времени. За время затишья народ расслабляется и больше подвержен атакам. Чтобы этого не произошло, и рассылаются подобные письма. 
Как бы ни говорили о том, что социальная инженерия через электронные письма — 
опасная вещь и она регулярно становится причиной проблем, эффективность этих 
рассказов все же далека от идеала. Реальность показывает, что люди часто игнорируют предупреждения в надежде, что их это не коснется. 
Но что может быть лучше реальных примеров? Поэтому у нас на работе как-то рассылали письмо, которое копировало популярную атаку хакеров и содержало ссылку на фейковый сайт. Говорят, что в результате достаточно большое количество 
сотрудников кликнуло по ссылке. 
Хакеры пользуются социальной инженерией незаметно, но эффективно. Вы даже 
не почувствуете подвоха, когда у вас попросят пароль или секретную информацию, 
и послушно все отдадите. Чтобы не попасться на крючок, вы должны иметь представление о том, какие методы социальной инженерии могут использоваться для 
достижения необходимой цели. С основными методами можно познакомиться в 
книге самого знаменитого хакера — Кевина Митника "Искусство обмана: контролирование человеческого фактора в безопасности". 
Социальная инженерия работает до сих пор, и очень много взломов по сей день совершается старым добрым методом — через почту заражается компьютер одного 
из сотрудников компании. Получив контроль над одним из компьютеров, заражается какое-то программное обеспечение в сети и идет дальнейшее продвижение. 
Пока что идет расследование недавнего взлома SolarWinds, но, похоже, именно так 
он и произошел. Хакеры подбросили зловредный код в одно из приложений, которое используется в компании, что привело в дальнейшем к очень серьезным последствиям. 
Хотя я и сказал, что не буду в данной книге уделять большого внимания социальной инженерии, давайте все же рассмотрим несколько рекомендаций, как защищаться от фейковых писем: 
 всегда проверяйте адрес отправителя. Очень часто почтовые программы прячут 
e-mail и показывают только имя отправителя. Если хакер отправит письмо от 
имени info-microsoft.com<an1930123@mail.ru>, то почтовая программа может 
отобразить только info-microsoft.com, а реальный адрес будет спрятан. При 
клике на имя программа все же покажет спрятанный e-mail и если это что-то типа an1930123@mail.ru, то письмо явно не от Microsoft. Вообще нужно обращать 
внимание на каждую мелочь в адресе. Солидные компании не рассылают письма 
от имени e-mail адресов, которые не вызывают доверия; 
 ссылки внутри письма также могут указывать на то, реальное перед нами письмо или нет. Если навести на ссылку мышкой, то должна появиться подсказка, 
которая точно будет указывать реальную ссылку, на которую мы попадем при 
клике. Если она вызывает доверие и реально указывает на сайт, о котором го-
Основы безопасности 15 
ворится в письме, то можно кликнуть. Если письмо от Microsoft со ссылкой 
m1cr0soft.com, то, конечно, же это фейк; 
 если ссылка указывает на сайт, который мы ожидаем, и домен не вызывал вопросов, открываем сайт и после загрузки еще раз проверяем ссылку в браузере. 
Дело в том, что на сайте могла быть уязвимость, которая после загрузки перенаправила вас на сайт хакера. У крупных компаний, таких как Microsoft или 
Google, подобное встречается сейчас крайне редко, и я уже не припомню, когда последний раз сообщали о подобном в новостях. Но на небольших сайтах 
такое еще случается